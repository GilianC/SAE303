(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();const w=await fetch("./src/ui/header/template.html"),S=await w.text();let f={};f.render=function(){return S};const M=await fetch("src/ui/Graph1/template.html"),v=await M.text();let d={render:function(){return v},renderChart:function(e,t){var a=e.map(o=>parseFloat(o.total)),l=t.map(o=>parseFloat(o.total)),n=e.map(o=>o.purchase_month);Highcharts.chart(document.querySelector("#container"),{title:{text:"Vente comparé à la location",align:"left"},yAxis:{title:{text:"Total"}},xAxis:{categories:n,accessibility:{rangeDescription:"Range: 2010 to 2016"}},legend:{layout:"vertical",align:"right",verticalAlign:"middle"},plotOptions:{series:{label:{connectorAllowed:!0}}},series:[{name:"Rental",data:a},{name:"Sales",data:l}],responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom",justify:"space-between"}}}]}}).container,console.log(a),console.log(l),console.log(n)}};const x=await fetch("./src/ui/Graph2/template.html"),b=await x.text();let p={render:function(){return b},renderChart:function(e){var t=e.get("Action").map(a=>a.month);Highcharts.chart(document.querySelector("#container1"),{title:{text:"Vente et location par genre",align:"left"},yAxis:{title:{text:"Total"}},xAxis:{categories:t},legend:{layout:"vertical",align:"right",verticalAlign:"middle"},plotOptions:{series:{label:{connectorAllowed:!1}}},series:[{name:"Action",data:e.get("Action").map(a=>parseFloat(a.total))},{name:"Animation",data:e.get("Animation").map(a=>parseFloat(a.total))},{name:"Comedy",data:e.get("Comedy").map(a=>parseFloat(a.total))},{name:"Drama",data:e.get("Drama").map(a=>parseFloat(a.total))},{name:"Horror",data:e.get("Horror").map(a=>parseFloat(a.total))},{name:"Romance",data:e.get("Romance").map(a=>parseFloat(a.total))},{name:"Sci-Fi",data:e.get("Sci-Fi").map(a=>parseFloat(a.total))},{name:"Thriller",data:e.get("Thriller").map(a=>parseFloat(a.total))}],responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom",justify:"space-between"}}}]}}).container,console.log(e.get("Action").map(a=>parseFloat(a.total)))}};const F=await fetch("./src/ui/Graph3/template.html"),G=await F.text();let m={render:function(){return G},renderChart:function(e){Highcharts.chart(document.querySelector("#container2"),{chart:{type:"column",width:700,height:500},title:{text:"Vente et location par pays",align:"left"},xAxis:{categories:e.get("Sales").map(t=>t.country)},yAxis:{min:0,title:{text:"Nombre de ventes et de locations"},stackLabels:{enabled:!0}},legend:{width:100,height:100,align:"left",x:70,verticalAlign:"top",y:70,floating:!0,backgroundColor:Highcharts.defaultOptions.legend.backgroundColor||"white",borderColor:"#CCC",borderWidth:1,shadow:!1,itemWidth:120,width:500,maxHeight:100},tooltip:{headerFormat:"<b>{category}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>Total: {point.stackTotal}"},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0}}},series:[{name:"Rentals",data:e.get("Rentals").map(t=>parseFloat(t.total))},{name:"Sales",data:e.get("Sales").map(t=>parseFloat(t.total))}]}).container,console.log(e.get("Sales").map(t=>parseFloat(t.total)))}};const C=await fetch("./src/ui/Graph4/template.html"),A=await C.text();let h={render:function(){return A},renderChart:function(e){console.log(e);let t,a=[],l=[];for(let n of e)a.push(n.month),t=n.movie_title,l.push(parseFloat(n.total));console.log(t),Highcharts.chart(document.querySelector("#container3"),{chart:{type:"area"},title:{text:"Vente par film",align:"left"},xAxis:{categories:e.map(n=>n.month)},yAxis:{title:{text:"Nombre de ventes"}},tooltip:{pointFormat:"{series.name} had stockpiled <b>{point.y:,.0f}</b><br/>warheads in {point.x}"},plotOptions:{area:{marker:{enabled:!1,symbol:"circle",radius:2,states:{hover:{enabled:!0}}}}},series:[{name:t,data:l}]}).container,console.log(l)}},R=function(e,t){let a=e;for(let l in t)a=a.replaceAll(new RegExp("{{"+l+"}}","g"),t[l]);return a};const H=await fetch("./src/ui/Select-Ite8/template.html"),L=await H.text();let g={render:function(e){let t="";for(let a of e)t+=R(L,a);return t}},q="https://mmi.unilim.fr/~cannier1/SAE303/api/",c=async function(e){let t={method:"GET"};try{var a=await fetch(q+e,t)}catch(n){return console.error("Echec de la requête : "+n),!1}return a.status!=200?(console.error("Erreur de requête : "+a.status),!1):await a.json()},i={};i.fetchForSixMonth=async function(){return await c("sales?param=salessixmonth")};i.fetchGenrePerMonth=async function(){return(await c("sales?param=salesgenremonth")).sort((a,l)=>a.genre.localeCompare(l.genre))};i.listMapsByGenre=async function(){let e=await this.fetchGenrePerMonth(),t=new Map;return e.forEach(a=>{t.has(a.genre)||t.set(a.genre,[]),t.get(a.genre).push(a)}),t};i.fetchCountryPerMonth=async function(){return(await c("sales?param=salespercountry")).sort((a,l)=>a.type.localeCompare(l.type))};i.listMapsByCountry=async function(){let e=await this.fetchCountryPerMonth(),t=new Map;return e.forEach(a=>{t.has(a.type)||t.set(a.type,[]),t.get(a.type).push(a)}),t};i.fetchAllMovie=async function(){return await c("sales?param=salesmoviestat")};i.fetchMoviePerStat=async function(e){return await c("sales?id="+e)};let s={};s.fetchForSixMonth=async function(){return await c("rental?param=rentalsixmonth")};s.fetchGenrePerMonth=async function(){return(await c("rental?param=rentalgenremonth")).sort((a,l)=>a.genre.localeCompare(l.genre))};s.listMapsByGenre=async function(){let e=await this.fetchGenrePerMonth(),t=new Map;return e.forEach(a=>{t.has(a.genre)||t.set(a.genre,[]),t.get(a.genre).push(a)}),t};s.fetchCountryPerMonth=async function(){return(await c("rental?param=rentalpercountry")).sort((a,l)=>a.country.localeCompare(l.country))};s.listMapsByCountry=async function(){let e=await this.fetchCountryPerMonth(),t=new Map;return e.forEach(a=>{t.has(a.country)||t.set(a.country,[]),t.get(a.country).push(a)}),t};s.fetchAllMovie=async function(){let e=await c("rental?param=rentalmoviestat");return console.log(e),e};s.fetchMoviePerStat=async function(e){return await c("rental?id="+e)};let y={};y.init=async function(){r.init(),addEventListener("change",async function(e){if(e.target.id==="select"){let t=e.target.value;r.renderGraph4Sales(t)}}),addEventListener("changeRent",async function(e){if(e.target.id==="selectrental"){let t=e.target.value;r.renderGraph4Rental(t)}})};let r={header:document.querySelector("#header"),graph1:document.querySelector("#graph1"),graph2Rental:document.querySelector("#graph2rental"),graph2Sales:document.querySelector("#graph2sales"),graph3Rental:document.querySelector("#graph3rental"),graph3:document.querySelector("#graph3"),graph4select:document.querySelector("#select"),graph4sales:document.querySelector("#graph4sales"),selectRental:document.querySelector("#selectrental"),graph4rental:document.querySelector("#graph4rental")};r.init=function(){r.renderHeader(),r.renderGraph1(),r.renderGraph2Rental(),r.renderGraph2Sales(),r.renderGraph3Sales(),r.renderSelect(),r.renderGraph4Sales(),r.renderSelectRental(),r.renderGraph4Rental()};r.renderHeader=function(){r.header.innerHTML=f.render()};r.renderGraph1=async function(){let e=await i.fetchForSixMonth(),t=await s.fetchForSixMonth(),a=d.render();r.graph1.innerHTML=a,d.renderChart(e,t)};r.renderGraph2Rental=async function(){let e=await s.listMapsByGenre(),t=p.render();r.graph2Rental.innerHTML=t,p.renderChart(e)};r.renderGraph2Sales=async function(){let e=await i.listMapsByGenre(),t=p.render();r.graph2Sales.innerHTML=t,p.renderChart(e)};r.renderGraph3Sales=async function(){let e=await i.listMapsByCountry(),t=m.render();r.graph3.innerHTML=t,m.renderChart(e)};r.renderSelect=async function(){let e=await i.fetchAllMovie(),t=g.render(e);r.graph4select.innerHTML=t};r.renderGraph4Sales=async function(e){let t=await i.fetchMoviePerStat(e),a=h.render();r.graph4sales.innerHTML=a,h.renderChart(t)};r.renderSelectRental=async function(){let e=await s.fetchAllMovie(),t=g.render(e);console.log(e),r.selectRental.innerHTML=t};r.renderGraph4Rental=async function(e){console.log(e);let t=await s.fetchMoviePerStat(e),a=h.render();r.graph4rental.innerHTML=a,h.renderChart(t)};y.init();
